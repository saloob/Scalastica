/*
 Rangy, a cross-browser JavaScript range and selection library
 http://code.google.com/p/rangy/

 Copyright 2012, Tim Down
 Licensed under the MIT license.
 Version: 1.2.3
 Build date: 26 February 2012
*/
window.rangy=function(){function e(b,c){var o=typeof b[c];return o==j||!!(o==d&&b[c])||"unknown"==o}function u(b,c){return!!(typeof b[c]==d&&b[c])}function r(b,c){return typeof b[c]!=k}function s(b){return function(c,o){for(var d=o.length;d--;)if(!b(c,o[d]))return!1;return!0}}function q(b){return b&&c(b,A)&&o(b,h)}function p(b){window.alert("Rangy not supported in your browser. Reason: "+b);n.initialized=!0;n.supported=!1}function x(){if(!n.initialized){var b,d=!1,j=!1;e(document,"createRange")&&
(b=document.createRange(),c(b,l)&&o(b,m)&&(d=!0),b.detach());if((b=u(document,"body")?document.body:document.getElementsByTagName("body")[0])&&e(b,"createTextRange"))b=b.createTextRange(),q(b)&&(j=!0);!d&&!j&&p("Neither Range nor TextRange are implemented");n.initialized=!0;n.features={implementsDomRange:d,implementsTextRange:j};d=F.concat(D);j=0;for(b=d.length;j<b;++j)try{d[j](n)}catch(h){u(window,"console")&&e(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",
h)}}}function y(b){this.name=b;this.supported=this.initialized=!1}var d="object",j="function",k="undefined",m="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer START_TO_START START_TO_END END_TO_START END_TO_END".split(" "),l="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),
h="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),A="collapse compareEndPoints duplicate getBookmark moveToBookmark moveToElementText parentElement pasteHTML select setEndPoint getBoundingClientRect".split(" "),c=s(e),b=s(u),o=s(r),n={version:"1.2.3",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:u,isHostProperty:r,areHostMethods:c,areHostObjects:b,areHostProperties:o,isTextRange:q},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};
n.fail=p;n.warn=function(b){b="Rangy warning: "+b;n.config.alertOnWarn?window.alert(b):typeof window.console!=k&&typeof window.console.log!=k&&window.console.log(b)};({}).hasOwnProperty?n.util.extend=function(b,c){for(var o in c)c.hasOwnProperty(o)&&(b[o]=c[o])}:p("hasOwnProperty not supported");var D=[],F=[];n.init=x;n.addInitListener=function(b){n.initialized?b(n):D.push(b)};var E=[];n.addCreateMissingNativeApiListener=function(b){E.push(b)};n.createMissingNativeApi=function(b){b=b||window;x();
for(var c=0,o=E.length;c<o;++c)E[c](b)};y.prototype.fail=function(b){this.initialized=!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+b);};y.prototype.warn=function(b){n.warn("Module "+this.name+": "+b)};y.prototype.createError=function(b){return Error("Error in Rangy "+this.name+" module: "+b)};n.createModule=function(b,c){var o=new y(b);n.modules[b]=o;F.push(function(b){c(b,o);o.initialized=!0;o.supported=!0})};n.requireModules=function(b){for(var c=0,o=b.length,d,e;c<
o;++c){e=b[c];d=n.modules[e];if(!d||!(d instanceof y))throw Error("Module '"+e+"' not found");if(!d.supported)throw Error("Module '"+e+"' not supported");}};var B=!1,b=function(){B||(B=!0,n.initialized||x())};if(typeof window==k)p("No window found");else if(typeof document==k)p("No document found");else return e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",b,!1),e(window,"addEventListener")?window.addEventListener("load",b,!1):e(window,"attachEvent")?window.attachEvent("onload",
b):p("Window does not have required addEventListener or attachEvent method"),n}();
rangy.createModule("DomUtil",function(e,u){function r(b){for(var c=0;b=b.previousSibling;)c++;return c}function s(b,o){var d=[],e;for(e=b;e;e=e.parentNode)d.push(e);for(e=o;e;e=e.parentNode)if(c(d,e))return e;return null}function q(b,c,d){for(d=d?b:b.parentNode;d;){b=d.parentNode;if(b===c)return d;d=b}return null}function p(b){b=b.nodeType;return 3==b||4==b||8==b}function x(b,c){var d=c.nextSibling,e=c.parentNode;d?e.insertBefore(b,d):e.appendChild(b);return b}function y(b){if(9==b.nodeType)return b;
if(typeof b.ownerDocument!=l)return b.ownerDocument;if(typeof b.document!=l)return b.document;if(b.parentNode)return y(b.parentNode);throw Error("getDocument: no document found for node");}function d(b){return!b?"[No node]":p(b)?'"'+b.data+'"':1==b.nodeType?"<"+b.nodeName+(b.id?' id="'+b.id+'"':"")+">["+b.childNodes.length+"]":b.nodeName}function j(b){this._next=this.root=b}function k(b,c){this.node=b;this.offset=c}function m(b){this.code=this[b];this.codeName=b;this.message="DOMException: "+this.codeName}
var l="undefined",h=e.util;h.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||u.fail("document missing a Node creation method");h.isHostMethod(document,"getElementsByTagName")||u.fail("document missing getElementsByTagName method");var A=document.createElement("div");h.areHostMethods(A,["insertBefore","appendChild","cloneNode"])||u.fail("Incomplete Element implementation");h.isHostProperty(A,"innerHTML")||u.fail("Element is missing innerHTML property");A=document.createTextNode("test");
h.areHostMethods(A,["splitText","deleteData","insertData","appendData","cloneNode"])||u.fail("Incomplete Text Node implementation");var c=function(b,c){for(var d=b.length;d--;)if(b[d]===c)return!0;return!1};j.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var b=this._current=this._next,c;if(this._current){c=b.firstChild;if(!c)for(c=null;b!==this.root&&!(c=b.nextSibling);)b=b.parentNode;this._next=c}return this._current},detach:function(){this._current=this._next=this.root=
null}};k.prototype={equals:function(b){return this.node===b.node&this.offset==b.offset},inspect:function(){return"[DomPosition("+d(this.node)+":"+this.offset+")]"}};m.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};m.prototype.toString=function(){return this.message};e.dom={arrayContains:c,isHtmlNamespace:function(b){var c;return typeof b.namespaceURI==l||null===(c=b.namespaceURI)||"http://www.w3.org/1999/xhtml"==
c},parentElement:function(b){b=b.parentNode;return 1==b.nodeType?b:null},getNodeIndex:r,getNodeLength:function(b){var c;return p(b)?b.length:(c=b.childNodes)?c.length:0},getCommonAncestor:s,isAncestorOf:function(b,c,d){for(c=d?c:c.parentNode;c;){if(c===b)return!0;c=c.parentNode}return!1},getClosestAncestorIn:q,isCharacterDataNode:p,insertAfter:x,splitDataNode:function(b,c){var d=b.cloneNode(!1);d.deleteData(0,c);b.deleteData(c,b.length-c);x(d,b);return d},getDocument:y,getWindow:function(b){b=y(b);
if(typeof b.defaultView!=l)return b.defaultView;if(typeof b.parentWindow!=l)return b.parentWindow;throw Error("Cannot get a window object for node");},getIframeWindow:function(b){if(typeof b.contentWindow!=l)return b.contentWindow;if(typeof b.contentDocument!=l)return b.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element");},getIframeDocument:function(b){if(typeof b.contentDocument!=l)return b.contentDocument;if(typeof b.contentWindow!=l)return b.contentWindow.document;
throw Error("getIframeWindow: No Document object found for iframe element");},getBody:function(b){return h.isHostObject(b,"body")?b.body:b.getElementsByTagName("body")[0]},getRootContainer:function(b){for(var c;c=b.parentNode;)b=c;return b},comparePoints:function(b,c,d,e){var j;if(b==d)return c===e?0:c<e?-1:1;if(j=q(d,b,!0))return c<=r(j)?-1:1;if(j=q(b,d,!0))return r(j)<e?-1:1;c=s(b,d);b=b===c?c:q(b,c,!0);d=d===c?c:q(d,c,!0);if(b===d)throw Error("comparePoints got to case 4 and childA and childB are the same!");
for(c=c.firstChild;c;){if(c===b)return-1;if(c===d)return 1;c=c.nextSibling}throw Error("Should not be here!");},inspectNode:d,fragmentFromNodeChildren:function(b){for(var c=y(b).createDocumentFragment(),d;d=b.firstChild;)c.appendChild(d);return c},createIterator:function(b){return new j(b)},DomPosition:k};e.DOMException=m});
rangy.createModule("DomRange",function(e){function u(f,a){return 3!=f.nodeType&&(g.isAncestorOf(f,a.startContainer,!0)||g.isAncestorOf(f,a.endContainer,!0))}function r(f){return g.getDocument(f.startContainer)}function s(f,a,b){if(a=f._listeners[a])for(var c=0,i=a.length;c<i;++c)a[c].call(f,{target:f,args:b})}function q(f){return new J(f.parentNode,g.getNodeIndex(f))}function p(f){return new J(f.parentNode,g.getNodeIndex(f)+1)}function x(f,a,b){var c=11==f.nodeType?f.firstChild:f;g.isCharacterDataNode(a)?
b==a.length?g.insertAfter(f,a):a.parentNode.insertBefore(f,0==b?a:g.splitDataNode(a,b)):b>=a.childNodes.length?a.appendChild(f):a.insertBefore(f,a.childNodes[b]);return c}function y(f){for(var a,b,c=r(f.range).createDocumentFragment();b=f.next();){a=f.isPartiallySelectedSubtree();b=b.cloneNode(!a);a&&(a=f.getSubtreeIterator(),b.appendChild(y(a)),a.detach(!0));if(10==b.nodeType)throw new C("HIERARCHY_REQUEST_ERR");c.appendChild(b)}return c}function d(f,a,b){for(var c,i,b=b||{stop:!1};c=f.next();)if(f.isPartiallySelectedSubtree())if(!1===
a(c)){b.stop=!0;break}else{if(c=f.getSubtreeIterator(),d(c,a,b),c.detach(!0),b.stop)break}else for(c=g.createIterator(c);i=c.next();)if(!1===a(i)){b.stop=!0;return}}function j(f){for(var a;f.next();)f.isPartiallySelectedSubtree()?(a=f.getSubtreeIterator(),j(a),a.detach(!0)):f.remove()}function k(f){for(var a,b=r(f.range).createDocumentFragment(),c;a=f.next();){f.isPartiallySelectedSubtree()?(a=a.cloneNode(!1),c=f.getSubtreeIterator(),a.appendChild(k(c)),c.detach(!0)):f.remove();if(10==a.nodeType)throw new C("HIERARCHY_REQUEST_ERR");
b.appendChild(a)}return b}function m(f,a,b){var c=!(!a||!a.length),i,e=!!b;c&&(i=RegExp("^("+a.join("|")+")$"));var g=[];d(new h(f,!1),function(f){(!c||i.test(f.nodeType))&&(!e||b(f))&&g.push(f)});return g}function l(f){return"["+("undefined"==typeof f.getName?"Range":f.getName())+"("+g.inspectNode(f.startContainer)+":"+f.startOffset+", "+g.inspectNode(f.endContainer)+":"+f.endOffset+")]"}function h(f,a){this.range=f;this.clonePartiallySelectedTextNodes=a;if(!f.collapsed){this.sc=f.startContainer;
this.so=f.startOffset;this.ec=f.endContainer;this.eo=f.endOffset;var b=f.commonAncestorContainer;this.sc===this.ec&&g.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===b&&!g.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:g.getClosestAncestorIn(this.sc,b,!0),this._last=this.ec===b&&!g.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:g.getClosestAncestorIn(this.ec,b,!0))}}function A(f){this.code=
this[f];this.codeName=f;this.message="RangeException: "+this.codeName}function c(f,a,b){this.nodes=m(f,a,b);this._next=this.nodes[0];this._position=0}function b(f){return function(a,b){for(var c,i=b?a:a.parentNode;i;){c=i.nodeType;if(g.arrayContains(f,c))return i;i=i.parentNode}return null}}function o(f,a){if(ba(f,a))throw new A("INVALID_NODE_TYPE_ERR");}function n(f){if(!f.startContainer)throw new C("INVALID_STATE_ERR");}function D(f,a){if(!g.arrayContains(a,f.nodeType))throw new A("INVALID_NODE_TYPE_ERR");
}function F(f,a){if(0>a||a>(g.isCharacterDataNode(f)?f.length:f.childNodes.length))throw new C("INDEX_SIZE_ERR");}function E(a,b){if(z(a,!0)!==z(b,!0))throw new C("WRONG_DOCUMENT_ERR");}function B(a){if(ca(a,!0))throw new C("NO_MODIFICATION_ALLOWED_ERR");}function w(a,b){if(!a)throw new C(b);}function H(a){return!!a.startContainer&&!!a.endContainer&&!(!g.arrayContains(N,a.startContainer.nodeType)&&!z(a.startContainer,!0))&&!(!g.arrayContains(N,a.endContainer.nodeType)&&!z(a.endContainer,!0))&&a.startOffset<=
(g.isCharacterDataNode(a.startContainer)?a.startContainer.length:a.startContainer.childNodes.length)&&a.endOffset<=(g.isCharacterDataNode(a.endContainer)?a.endContainer.length:a.endContainer.childNodes.length)}function t(a){n(a);if(!H(a))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")");}function M(){}function I(a){a.START_TO_START=S;a.START_TO_END=W;a.END_TO_END=da;a.END_TO_START=X;a.NODE_BEFORE=Y;a.NODE_AFTER=Z;a.NODE_BEFORE_AND_AFTER=$;a.NODE_INSIDE=T}function G(a){I(a);
I(a.prototype)}function O(a,b){return function(){t(this);var c=this.startContainer,i=this.startOffset,e=this.commonAncestorContainer,z=new h(this,!0);c!==e&&(c=g.getClosestAncestorIn(c,e,!0),i=p(c),c=i.node,i=i.offset);d(z,B);z.reset();e=a(z);z.detach();b(this,c,i,c,i);return e}}function Q(a,b,c){function d(a,b){return function(f){n(this);D(f,K);D(i(f),N);f=(a?q:p)(f);(b?z:l)(this,f.node,f.offset)}}function z(a,f,c){var d=a.endContainer,e=a.endOffset;if(f!==a.startContainer||c!==a.startOffset){if(i(f)!=
i(d)||1==g.comparePoints(f,c,d,e))d=f,e=c;b(a,f,c,d,e)}}function l(a,f,c){var d=a.startContainer,e=a.startOffset;if(f!==a.endContainer||c!==a.endOffset){if(i(f)!=i(d)||-1==g.comparePoints(f,c,d,e))d=f,e=c;b(a,d,e,f,c)}}a.prototype=new M;e.util.extend(a.prototype,{setStart:function(a,f){n(this);o(a,!0);F(a,f);z(this,a,f)},setEnd:function(a,f){n(this);o(a,!0);F(a,f);l(this,a,f)},setStartBefore:d(!0,!0),setStartAfter:d(!1,!0),setEndBefore:d(!0,!1),setEndAfter:d(!1,!1),collapse:function(a){t(this);a?
b(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):b(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){n(this);o(a,!0);b(this,a,0,a,g.getNodeLength(a))},selectNode:function(a){n(this);o(a,!1);D(a,K);var f=q(a),a=p(a);b(this,f.node,f.offset,a.node,a.offset)},extractContents:O(k,b),deleteContents:O(j,b),canSurroundContents:function(){t(this);B(this.startContainer);B(this.endContainer);var a=new h(this,!0),f=a._first&&
u(a._first,this)||a._last&&u(a._last,this);a.detach();return!f},detach:function(){c(this)},splitBoundaries:function(){t(this);var a=this.startContainer,f=this.startOffset,c=this.endContainer,i=this.endOffset,d=a===c;g.isCharacterDataNode(c)&&(0<i&&i<c.length)&&g.splitDataNode(c,i);g.isCharacterDataNode(a)&&(0<f&&f<a.length)&&(a=g.splitDataNode(a,f),d?(i-=f,c=a):c==a.parentNode&&i>=g.getNodeIndex(a)&&i++,f=0);b(this,a,f,c,i)},normalizeBoundaries:function(){t(this);var a=this.startContainer,f=this.startOffset,
c=this.endContainer,i=this.endOffset,d=function(a){var f=a.nextSibling;f&&f.nodeType==a.nodeType&&(c=a,i=a.length,a.appendData(f.data),f.parentNode.removeChild(f))},e=function(b){var d=b.previousSibling;if(d&&d.nodeType==b.nodeType){a=b;var e=b.length;f=d.length;b.insertData(0,d.data);d.parentNode.removeChild(d);a==c?(i+=f,c=a):c==b.parentNode&&(d=g.getNodeIndex(b),i==d?(c=b,i=e):i>d&&i--)}},z=!0;g.isCharacterDataNode(c)?c.length==i&&d(c):(0<i&&(z=c.childNodes[i-1])&&g.isCharacterDataNode(z)&&d(z),
z=!this.collapsed);z?g.isCharacterDataNode(a)?0==f&&e(a):f<a.childNodes.length&&(d=a.childNodes[f])&&g.isCharacterDataNode(d)&&e(d):(a=c,f=i);b(this,a,f,c,i)},collapseToPoint:function(a,f){n(this);o(a,!0);F(a,f);(a!==this.startContainer||f!==this.startOffset||a!==this.endContainer||f!==this.endOffset)&&b(this,a,f,a,f)}});G(a)}function P(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=a.collapsed?a.startContainer:g.getCommonAncestor(a.startContainer,
a.endContainer)}function R(a,b,c,i,d){var e=a.startContainer!==b||a.startOffset!==c,g=a.endContainer!==i||a.endOffset!==d;a.startContainer=b;a.startOffset=c;a.endContainer=i;a.endOffset=d;P(a);s(a,"boundarychange",{startMoved:e,endMoved:g})}function v(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};P(this)}e.requireModules(["DomUtil"]);var g=e.dom,J=g.DomPosition,C=e.DOMException;h.prototype={_current:null,_next:null,_first:null,
_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=a!==this._last?a.nextSibling:null,g.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));return a},remove:function(){var a=this._current,b,c;g.isCharacterDataNode(a)&&
(a===this.sc||a===this.ec)?(b=a===this.sc?this.so:0,c=a===this.ec?this.eo:a.length,b!=c&&a.deleteData(b,c-b)):a.parentNode&&a.parentNode.removeChild(a)},isPartiallySelectedSubtree:function(){return u(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new v(r(this.range));var b=this._current,c=b,i=0,d=b,e=g.getNodeLength(b);g.isAncestorOf(b,this.sc,!0)&&(c=this.sc,i=this.so);g.isAncestorOf(b,this.ec,!0)&&(d=
this.ec,e=this.eo);R(a,c,i,d,e)}return new h(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach();this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};A.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};A.prototype.toString=function(){return this.message};c.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},
detach:function(){this._current=this._next=this.nodes=null}};var K=[1,3,4,5,7,8,10],N=[2,9,11],L=[1,3,4,5,7,8,10,11],a=[1,3,4,5,7,8],i=g.getRootContainer,z=b([9,11]),ca=b([5,6,10,12]),ba=b([6,10,12]),aa=document.createElement("style"),U=!1;try{aa.innerHTML="<b>x</b>",U=3==aa.firstChild.nodeType}catch(ea){}e.features.htmlParsingConforms=U;var V="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),S=0,W=1,da=2,X=3,Y=0,Z=1,$=2,T=3;M.prototype={attachListener:function(a,
b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){t(this);E(this.startContainer,b.startContainer);var c=a==X||a==S?"start":"end",i=a==W||a==S?"start":"end";return g.comparePoints(this[c+"Container"],this[c+"Offset"],b[i+"Container"],b[i+"Offset"])},insertNode:function(a){t(this);D(a,L);B(this.startContainer);if(g.isAncestorOf(a,this.startContainer,!0))throw new C("HIERARCHY_REQUEST_ERR");this.setStartBefore(x(a,this.startContainer,this.startOffset))},cloneContents:function(){t(this);
var a,b;if(this.collapsed)return r(this).createDocumentFragment();if(this.startContainer===this.endContainer&&g.isCharacterDataNode(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=r(this).createDocumentFragment(),b.appendChild(a),b;b=new h(this,!0);a=y(b);b.detach();return a},canSurroundContents:function(){t(this);B(this.startContainer);B(this.endContainer);var a=new h(this,!0),b=a._first&&u(a._first,this)||a._last&&u(a._last,
this);a.detach();return!b},surroundContents:function(b){D(b,a);if(!this.canSurroundContents())throw new A("BAD_BOUNDARYPOINTS_ERR");var c=this.extractContents();if(b.hasChildNodes())for(;b.lastChild;)b.removeChild(b.lastChild);x(b,this.startContainer,this.startOffset);b.appendChild(c);this.selectNode(b)},cloneRange:function(){t(this);for(var a=new v(r(this)),b=V.length,c;b--;)c=V[b],a[c]=this[c];return a},toString:function(){t(this);var a=this.startContainer;if(a===this.endContainer&&g.isCharacterDataNode(a))return 3==
a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],a=new h(this,!0);d(a,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)});a.detach();return b.join("")},compareNode:function(a){t(this);var b=a.parentNode,c=g.getNodeIndex(a);if(!b)throw new C("NOT_FOUND_ERR");a=this.comparePoint(b,c);b=this.comparePoint(b,c+1);return 0>a?0<b?$:Y:0<b?Z:T},comparePoint:function(a,b){t(this);w(a,"HIERARCHY_REQUEST_ERR");E(a,this.startContainer);return 0>g.comparePoints(a,b,this.startContainer,
this.startOffset)?-1:0<g.comparePoints(a,b,this.endContainer,this.endOffset)?1:0},createContextualFragment:U?function(a){var b=this.startContainer,c=g.getDocument(b);if(!b)throw new C("INVALID_STATE_ERR");var i=null;1==b.nodeType?i=b:g.isCharacterDataNode(b)&&(i=g.parentElement(b));i=null===i||"HTML"==i.nodeName&&g.isHtmlNamespace(g.getDocument(i).documentElement)&&g.isHtmlNamespace(i)?c.createElement("body"):i.cloneNode(!1);i.innerHTML=a;return g.fragmentFromNodeChildren(i)}:function(a){n(this);
var b=r(this).createElement("body");b.innerHTML=a;return g.fragmentFromNodeChildren(b)},toHtml:function(){t(this);var a=r(this).createElement("div");a.appendChild(this.cloneContents());return a.innerHTML},intersectsNode:function(a,b){t(this);w(a,"NOT_FOUND_ERR");if(g.getDocument(a)!==r(this))return!1;var c=a.parentNode,i=g.getNodeIndex(a);w(c,"NOT_FOUND_ERR");var d=g.comparePoints(c,i,this.endContainer,this.endOffset),c=g.comparePoints(c,i+1,this.startContainer,this.startOffset);return b?0>=d&&0<=
c:0>d&&0<c},isPointInRange:function(a,b){t(this);w(a,"HIERARCHY_REQUEST_ERR");E(a,this.startContainer);return 0<=g.comparePoints(a,b,this.startContainer,this.startOffset)&&0>=g.comparePoints(a,b,this.endContainer,this.endOffset)},intersectsRange:function(a,b){t(this);if(r(a)!=r(this))throw new C("WRONG_DOCUMENT_ERR");var c=g.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),i=g.comparePoints(this.endContainer,this.endOffset,a.startContainer,a.startOffset);return b?0>=
c&&0<=i:0>c&&0<i},intersection:function(a){if(this.intersectsRange(a)){var b=g.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=g.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),i=this.cloneRange();-1==b&&i.setStart(a.startContainer,a.startOffset);1==c&&i.setEnd(a.endContainer,a.endOffset);return i}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();-1==g.comparePoints(a.startContainer,a.startOffset,this.startContainer,
this.startOffset)&&b.setStart(a.startContainer,a.startOffset);1==g.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset);return b}throw new A("Ranges do not intersect");},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==T},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,g.getNodeLength(a))},containsRange:function(a){return this.intersection(a).equals(a)},containsNodeText:function(a){var b=
this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);return 0<c.length?(b.setStart(c[0],0),a=c.pop(),b.setEnd(a,a.length),a=this.containsRange(b),b.detach(),a):this.containsNodeContents(a)},createNodeIterator:function(a,b){t(this);return new c(this,a,b)},getNodes:function(a,b){t(this);return m(this,a,b)},getDocument:function(){return r(this)},collapseBefore:function(a){n(this);this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){n(this);this.setStartAfter(a);this.collapse(!0)},getName:function(){return"DomRange"},
equals:function(a){return v.rangesEqual(this,a)},isValid:function(){return H(this)},inspect:function(){return l(this)}};Q(v,R,function(a){n(a);a.startContainer=a.startOffset=a.endContainer=a.endOffset=null;a.collapsed=a.commonAncestorContainer=null;s(a,"detach",null);a._listeners=null});e.rangePrototype=M.prototype;v.rangeProperties=V;v.RangeIterator=h;v.copyComparisonConstants=G;v.createPrototypeRange=Q;v.inspect=l;v.getRangeDocument=r;v.rangesEqual=function(a,b){return a.startContainer===b.startContainer&&
a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset};e.DomRange=v;e.RangeException=A});
rangy.createModule("WrappedRange",function(e){function u(d,e,k,m){var l=d.duplicate();l.collapse(k);var h=l.parentElement();q.isAncestorOf(e,h,!0)||(h=e);if(!h.canHaveHTML)return new p(h.parentNode,q.getNodeIndex(h));var e=q.getDocument(h).createElement("span"),r,c=k?"StartToStart":"StartToEnd";do h.insertBefore(e,e.previousSibling),l.moveToElementText(e);while(0<(r=l.compareEndPoints(c,d))&&e.previousSibling);c=e.nextSibling;if(-1==r&&c&&q.isCharacterDataNode(c)){l.setEndPoint(k?"EndToStart":"EndToEnd",
d);if(/[\r\n]/.test(c.data)){h=l.duplicate();k=h.text.replace(/\r\n/g,"\r").length;for(k=h.moveStart("character",k);-1==h.compareEndPoints("StartToEnd",h);)k++,h.moveStart("character",1)}else k=l.text.length;h=new p(c,k)}else c=(m||!k)&&e.previousSibling,h=(k=(m||k)&&e.nextSibling)&&q.isCharacterDataNode(k)?new p(k,0):c&&q.isCharacterDataNode(c)?new p(c,c.length):new p(h,q.getNodeIndex(e));e.parentNode.removeChild(e);return h}function r(d,e){var k,m,l=d.offset,h=q.getDocument(d.node),p=h.body.createTextRange(),
c=q.isCharacterDataNode(d.node);c?(k=d.node,m=k.parentNode):(k=d.node.childNodes,k=l<k.length?k[l]:null,m=d.node);h=h.createElement("span");h.innerHTML="&#feff;";k?m.insertBefore(h,k):m.appendChild(h);p.moveToElementText(h);p.collapse(!e);m.removeChild(h);if(c)p[e?"moveStart":"moveEnd"]("character",l);return p}e.requireModules(["DomUtil","DomRange"]);var s,q=e.dom,p=q.DomPosition,x=e.DomRange;if(e.features.implementsDomRange&&(!e.features.implementsTextRange||!e.config.preferTextRange))(function(){function d(c){for(var b=
k.length,d;b--;)d=k[b],c[d]=c.nativeRange[d]}var j,k=x.rangeProperties,m;s=function(c){if(!c)throw Error("Range must be specified");this.nativeRange=c;d(this)};x.createPrototypeRange(s,function(c,b,d,e,j){var h=c.endContainer!==e||c.endOffset!=j;if(c.startContainer!==b||c.startOffset!=d||h)c.setEnd(e,j),c.setStart(b,d)},function(c){c.nativeRange.detach();c.detached=!0;for(var b=k.length,d;b--;)d=k[b],c[d]=null});j=s.prototype;j.selectNode=function(c){this.nativeRange.selectNode(c);d(this)};j.deleteContents=
function(){this.nativeRange.deleteContents();d(this)};j.extractContents=function(){var c=this.nativeRange.extractContents();d(this);return c};j.cloneContents=function(){return this.nativeRange.cloneContents()};j.surroundContents=function(c){this.nativeRange.surroundContents(c);d(this)};j.collapse=function(c){this.nativeRange.collapse(c);d(this)};j.cloneRange=function(){return new s(this.nativeRange.cloneRange())};j.refresh=function(){d(this)};j.toString=function(){return this.nativeRange.toString()};
var l=document.createTextNode("test");q.getBody(document).appendChild(l);var h=document.createRange();h.setStart(l,0);h.setEnd(l,0);try{h.setStart(l,1),j.setStart=function(c,b){this.nativeRange.setStart(c,b);d(this)},j.setEnd=function(c,b){this.nativeRange.setEnd(c,b);d(this)},m=function(c){return function(b){this.nativeRange[c](b);d(this)}}}catch(p){j.setStart=function(c,b){try{this.nativeRange.setStart(c,b)}catch(e){this.nativeRange.setEnd(c,b),this.nativeRange.setStart(c,b)}d(this)},j.setEnd=function(c,
b){try{this.nativeRange.setEnd(c,b)}catch(e){this.nativeRange.setStart(c,b),this.nativeRange.setEnd(c,b)}d(this)},m=function(c,b){return function(e){try{this.nativeRange[c](e)}catch(j){this.nativeRange[b](e),this.nativeRange[c](e)}d(this)}}}j.setStartBefore=m("setStartBefore","setEndBefore");j.setStartAfter=m("setStartAfter","setEndAfter");j.setEndBefore=m("setEndBefore","setStartBefore");j.setEndAfter=m("setEndAfter","setStartAfter");h.selectNodeContents(l);j.selectNodeContents=h.startContainer==
l&&h.endContainer==l&&0==h.startOffset&&h.endOffset==l.length?function(c){this.nativeRange.selectNodeContents(c);d(this)}:function(c){this.setStart(c,0);this.setEnd(c,x.getEndOffset(c))};h.selectNodeContents(l);h.setEnd(l,3);m=document.createRange();m.selectNodeContents(l);m.setEnd(l,4);m.setStart(l,2);j.compareBoundaryPoints=-1==h.compareBoundaryPoints(h.START_TO_END,m)&1==h.compareBoundaryPoints(h.END_TO_START,m)?function(c,b){b=b.nativeRange||b;c==b.START_TO_END?c=b.END_TO_START:c==b.END_TO_START&&
(c=b.START_TO_END);return this.nativeRange.compareBoundaryPoints(c,b)}:function(c,b){return this.nativeRange.compareBoundaryPoints(c,b.nativeRange||b)};e.util.isHostMethod(h,"createContextualFragment")&&(j.createContextualFragment=function(c){return this.nativeRange.createContextualFragment(c)});q.getBody(document).removeChild(l);h.detach();m.detach()})(),e.createNativeRange=function(d){d=d||document;return d.createRange()};else if(e.features.implementsTextRange){s=function(d){this.textRange=d;this.refresh()};
s.prototype=new x(document);s.prototype.refresh=function(){var d,e,k=this.textRange;d=k.parentElement();var m=k.duplicate();m.collapse(!0);e=m.parentElement();m=k.duplicate();m.collapse(!1);k=m.parentElement();e=e==k?e:q.getCommonAncestor(e,k);e=e==d?e:q.getCommonAncestor(d,e);0==this.textRange.compareEndPoints("StartToEnd",this.textRange)?e=d=u(this.textRange,e,!0,!0):(d=u(this.textRange,e,!0,!1),e=u(this.textRange,e,!1,!1));this.setStart(d.node,d.offset);this.setEnd(e.node,e.offset)};x.copyComparisonConstants(s);
var y=function(){return this}();"undefined"==typeof y.Range&&(y.Range=s);e.createNativeRange=function(d){d=d||document;return d.body.createTextRange()}}e.features.implementsTextRange&&(s.rangeToTextRange=function(d){if(d.collapsed)return r(new p(d.startContainer,d.startOffset),!0);var e=r(new p(d.startContainer,d.startOffset),!0),k=r(new p(d.endContainer,d.endOffset),!1),d=q.getDocument(d.startContainer).body.createTextRange();d.setEndPoint("StartToStart",e);d.setEndPoint("EndToEnd",k);return d});
s.prototype.getName=function(){return"WrappedRange"};e.WrappedRange=s;e.createRange=function(d){d=d||document;return new s(e.createNativeRange(d))};e.createRangyRange=function(d){d=d||document;return new x(d)};e.createIframeRange=function(d){return e.createRange(q.getIframeDocument(d))};e.createIframeRangyRange=function(d){return e.createRangyRange(q.getIframeDocument(d))};e.addCreateMissingNativeApiListener(function(d){d=d.document;if(typeof d.createRange=="undefined")d.createRange=function(){return e.createRange(this)};
d=d=null})});
rangy.createModule("WrappedSelection",function(e,u){function r(a){return(a||window).getSelection()}function s(a){return(a||window).document.selection}function q(a,b,c){var d=c?"end":"start",c=c?"start":"end";a.anchorNode=b[d+"Container"];a.anchorOffset=b[d+"Offset"];a.focusNode=b[c+"Container"];a.focusOffset=b[c+"Offset"]}function p(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function x(a){var b;a instanceof o?(b=a._selectionNativeRange,
b||(b=e.createNativeRange(c.getDocument(a.startContainer)),b.setEnd(a.endContainer,a.endOffset),b.setStart(a.startContainer,a.startOffset),a._selectionNativeRange=b,a.attachListener("detach",function(){this._selectionNativeRange=null}))):a instanceof n?b=a.nativeRange:e.features.implementsDomRange&&a instanceof c.getWindow(a.startContainer).Range&&(b=a);return b}function y(a){var b=a.getNodes(),d;a:if(!b.length||1!=b[0].nodeType)d=!1;else{d=1;for(var e=b.length;d<e;++d)if(!c.isAncestorOf(b[0],b[d])){d=
!1;break a}d=!0}if(!d)throw Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return b[0]}function d(a,b){var c=new n(b);a._ranges=[c];q(a,c,!1);a.rangeCount=1;a.isCollapsed=c.collapsed}function j(a){a._ranges.length=0;if("None"==a.docSelection.type)p(a);else{var b=a.docSelection.createRange();if(b&&"undefined"!=typeof b.text)d(a,b);else{a.rangeCount=b.length;for(var g,h=c.getDocument(b.item(0)),j=0;j<a.rangeCount;++j)g=e.createRange(h),g.selectNode(b.item(j)),
a._ranges.push(g);a.isCollapsed=1==a.rangeCount&&a._ranges[0].collapsed;q(a,a._ranges[a.rangeCount-1],!1)}}}function k(a,b){for(var d=a.docSelection.createRange(),e=y(b),g=c.getDocument(d.item(0)),g=c.getBody(g).createControlRange(),h=0,k=d.length;h<k;++h)g.add(d.item(h));try{g.add(e)}catch(l){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");}g.select();j(a)}function m(a,b,c){this.nativeSelection=a;this.docSelection=b;this._ranges=
[];this.win=c;this.refresh()}function l(a,b){for(var d=c.getDocument(b[0].startContainer),d=c.getBody(d).createControlRange(),e=0,g;e<rangeCount;++e){g=y(b[e]);try{d.add(g)}catch(h){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)");}}d.select();j(a)}function h(a,b){if(a.anchorNode&&c.getDocument(a.anchorNode)!==c.getDocument(b))throw new D("WRONG_DOCUMENT_ERR");}function A(a){var b=[],c=new F(a.anchorNode,a.anchorOffset),
d=new F(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var g=0,h=a.rangeCount;g<h;++g)b[g]=o.inspect(a.getRangeAt(g));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]);e.config.checkSelectionRanges=!0;var c=e.dom,b=e.util,o=e.DomRange,n=e.WrappedRange,D=e.DOMException,F=c.DomPosition,E,B,w=e.util.isHostMethod(window,"getSelection"),
H=e.util.isHostObject(document,"selection"),t=H&&(!w||e.config.preferTextRange);t?(E=s,e.isSelectionValid=function(a){var a=(a||window).document,b=a.selection;return"None"!=b.type||c.getDocument(b.createRange().parentElement())==a}):w?(E=r,e.isSelectionValid=function(){return!0}):u.fail("Neither document.selection or window.getSelection() detected.");e.getNativeSelection=E;var w=E(),M=e.createNativeRange(document),I=c.getBody(document),G=b.areHostObjects(w,b.areHostProperties(w,["anchorOffset","focusOffset"]));
e.features.selectionHasAnchorAndFocus=G;var O=b.isHostMethod(w,"extend");e.features.selectionHasExtend=O;var Q="number"==typeof w.rangeCount;e.features.selectionHasRangeCount=Q;var P=!1,R=!0;b.areHostMethods(w,["addRange","getRangeAt","removeAllRanges"])&&("number"==typeof w.rangeCount&&e.features.implementsDomRange)&&function(){var a=document.createElement("iframe");a.frameBorder=0;a.style.position="absolute";a.style.left="-10000px";I.appendChild(a);var b=c.getIframeDocument(a);b.open();b.write("<html><head></head><body>12</body></html>");
b.close();var d=c.getIframeWindow(a).getSelection(),e=b.documentElement.lastChild.firstChild,b=b.createRange();b.setStart(e,1);b.collapse(true);d.addRange(b);R=d.rangeCount==1;d.removeAllRanges();var g=b.cloneRange();b.setStart(e,0);g.setEnd(e,2);d.addRange(b);d.addRange(g);P=d.rangeCount==2;b.detach();g.detach();I.removeChild(a)}();e.features.selectionSupportsMultipleRanges=P;e.features.collapsedNonEditableSelectionsSupported=R;var v=!1,g;I&&b.isHostMethod(I,"createControlRange")&&(g=I.createControlRange(),
b.areHostProperties(g,["item","add"])&&(v=!0));e.features.implementsControlRange=v;B=G?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:false};var J;b.isHostMethod(w,"getRangeAt")?J=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:G&&(J=function(a){var b=c.getDocument(a.anchorNode),b=e.createRange(b);b.setStart(a.anchorNode,a.anchorOffset);b.setEnd(a.focusNode,a.focusOffset);if(b.collapsed!==
this.isCollapsed){b.setStart(a.focusNode,a.focusOffset);b.setEnd(a.anchorNode,a.anchorOffset)}return b});e.getSelection=function(a){var a=a||window,b=a._rangySelection,c=E(a),d=H?s(a):null;if(b){b.nativeSelection=c;b.docSelection=d;b.refresh(a)}else{b=new m(c,d,a);a._rangySelection=b}return b};e.getIframeSelection=function(a){return e.getSelection(c.getIframeWindow(a))};g=m.prototype;if(!t&&G&&b.areHostMethods(w,["removeAllRanges","addRange"])){g.removeAllRanges=function(){this.nativeSelection.removeAllRanges();
p(this)};var C=function(a,b){var c=o.getRangeDocument(b),c=e.createRange(c);c.collapseToPoint(b.endContainer,b.endOffset);a.nativeSelection.addRange(x(c));a.nativeSelection.extend(b.startContainer,b.startOffset);a.refresh()};g.addRange=Q?function(a,b){if(v&&H&&this.docSelection.type=="Control")k(this,a);else if(b&&O)C(this,a);else{var c;if(P)c=this.rangeCount;else{this.removeAllRanges();c=0}this.nativeSelection.addRange(x(a));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==c+1){if(e.config.checkSelectionRanges)(c=
J(this.nativeSelection,this.rangeCount-1))&&!o.rangesEqual(c,a)&&(a=new n(c));this._ranges[this.rangeCount-1]=a;q(this,a,L(this.nativeSelection));this.isCollapsed=B(this)}else this.refresh()}}:function(a,b){if(b&&O)C(this,a);else{this.nativeSelection.addRange(x(a));this.refresh()}};g.setRanges=function(a){if(v&&a.length>1)l(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;b<c;++b)this.addRange(a[b])}}}else if(b.isHostMethod(w,"empty")&&b.isHostMethod(M,"select")&&v&&t)g.removeAllRanges=
function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var a;if(this.anchorNode)a=c.getDocument(this.anchorNode);else if(this.docSelection.type=="Control"){var b=this.docSelection.createRange();b.length&&(a=c.getDocument(b.item(0)).body.createTextRange())}if(a){a.body.createTextRange().select();this.docSelection.empty()}}}catch(d){}p(this)},g.addRange=function(a){if(this.docSelection.type=="Control")k(this,a);else{n.rangeToTextRange(a).select();this._ranges[0]=a;this.rangeCount=
1;this.isCollapsed=this._ranges[0].collapsed;q(this,a,false)}},g.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?l(this,a):b&&this.addRange(a[0])};else return u.fail("No means of selecting a Range or TextRange was found"),!1;g.getRangeAt=function(a){if(a<0||a>=this.rangeCount)throw new D("INDEX_SIZE_ERR");return this._ranges[a]};var K;if(t)K=function(a){var b;if(e.isSelectionValid(a.win))b=a.docSelection.createRange();else{b=c.getBody(a.win.document).createTextRange();b.collapse(true)}a.docSelection.type==
"Control"?j(a):b&&typeof b.text!="undefined"?d(a,b):p(a)};else if(b.isHostMethod(w,"getRangeAt")&&"number"==typeof w.rangeCount)K=function(a){if(v&&H&&a.docSelection.type=="Control")j(a);else{a._ranges.length=a.rangeCount=a.nativeSelection.rangeCount;if(a.rangeCount){for(var b=0,c=a.rangeCount;b<c;++b)a._ranges[b]=new e.WrappedRange(a.nativeSelection.getRangeAt(b));q(a,a._ranges[a.rangeCount-1],L(a.nativeSelection));a.isCollapsed=B(a)}else p(a)}};else if(G&&"boolean"==typeof w.isCollapsed&&"boolean"==
typeof M.collapsed&&e.features.implementsDomRange)K=function(a){var b;b=a.nativeSelection;if(b.anchorNode){b=J(b,0);a._ranges=[b];a.rangeCount=1;b=a.nativeSelection;a.anchorNode=b.anchorNode;a.anchorOffset=b.anchorOffset;a.focusNode=b.focusNode;a.focusOffset=b.focusOffset;a.isCollapsed=B(a)}else p(a)};else return u.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;g.refresh=function(a){var b=a?this._ranges.slice(0):null;K(this);if(a){a=b.length;if(a!=this._ranges.length)return false;
for(;a--;)if(!o.rangesEqual(b[a],this._ranges[a]))return false;return true}};var N=function(a,b){var c=a.getAllRanges(),d=false;a.removeAllRanges();for(var e=0,g=c.length;e<g;++e)d||b!==c[e]?a.addRange(c[e]):d=true;a.rangeCount||p(a)};g.removeRange=v?function(a){if(this.docSelection.type=="Control"){for(var b=this.docSelection.createRange(),a=y(a),d=c.getDocument(b.item(0)),d=c.getBody(d).createControlRange(),e,g=false,h=0,k=b.length;h<k;++h){e=b.item(h);e!==a||g?d.add(b.item(h)):g=true}d.select();
j(this)}else N(this,a)}:function(a){N(this,a)};var L;!t&&G&&e.features.implementsDomRange?(L=function(a){var b=false;a.anchorNode&&(b=c.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)==1);return b},g.isBackwards=function(){return L(this)}):L=g.isBackwards=function(){return false};g.toString=function(){for(var a=[],b=0,c=this.rangeCount;b<c;++b)a[b]=""+this._ranges[b];return a.join("")};g.collapse=function(a,b){h(this,a);var d=e.createRange(c.getDocument(a));d.collapseToPoint(a,
b);this.removeAllRanges();this.addRange(d);this.isCollapsed=true};g.collapseToStart=function(){if(this.rangeCount){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new D("INVALID_STATE_ERR");};g.collapseToEnd=function(){if(this.rangeCount){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new D("INVALID_STATE_ERR");};g.selectAllChildren=function(a){h(this,a);var b=e.createRange(c.getDocument(a));b.selectNodeContents(a);this.removeAllRanges();
this.addRange(b)};g.deleteFromDocument=function(){if(v&&H&&this.docSelection.type=="Control"){for(var a=this.docSelection.createRange(),b;a.length;){b=a.item(0);a.remove(b);b.parentNode.removeChild(b)}this.refresh()}else if(this.rangeCount){a=this.getAllRanges();this.removeAllRanges();b=0;for(var c=a.length;b<c;++b)a[b].deleteContents();this.addRange(a[c-1])}};g.getAllRanges=function(){return this._ranges.slice(0)};g.setSingleRange=function(a){this.setRanges([a])};g.containsNode=function(a,b){for(var c=
0,d=this._ranges.length;c<d;++c)if(this._ranges[c].containsNode(a,b))return true;return false};g.toHtml=function(){var a="";if(this.rangeCount){for(var a=o.getRangeDocument(this._ranges[0]).createElement("div"),b=0,c=this._ranges.length;b<c;++b)a.appendChild(this._ranges[b].cloneContents());a=a.innerHTML}return a};g.getName=function(){return"WrappedSelection"};g.inspect=function(){return A(this)};g.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null};m.inspect=
A;e.Selection=m;e.selectionPrototype=g;e.addCreateMissingNativeApiListener(function(a){if(typeof a.getSelection=="undefined")a.getSelection=function(){return e.getSelection(this)};a=null})});