(function(){var g=this.ice,i=function(g){this._ice=g};i.prototype={convert:function(h){var b=this;try{b._ice.placeholdDeletes(),g.dom.each(h.getElementsByTagName(this._ice.blockEl),function(c,e){b._convertBlock(e)})}catch(c){window.console&&console.error(c)}finally{b._ice.revertDeletePlaceholders()}},_convertBlock:function(h){if(!(2>g.dom.getNodeTextContent(h))){var b,c,d,e,j,i=String.fromCharCode(8216),k=String.fromCharCode(8217),m=String.fromCharCode(8220),n=String.fromCharCode(8221),f=function(a){return a===
String.fromCharCode(160)||a===String.fromCharCode(32)},l=function(a){return f(a)||null==a||";"===a||")"===a||"."==a||"!"===a||","===a||"?"===a||":"===a},o=function(a){return"'"===a||a===i||a===k};e=g.dom.getHtml(h).match(/(<("[^"]*"|'[^']*'|[^'">])*>|&.*;|.)/g);j=function(a,b,c){var e=a.length,d=0>c?-1:1;return function p(a,b,c){if(0>b||b>=e)return null;var f=a[b+d];return f&&1==f.length&&(c+=-1*d,!c)?f:p(a,b+d,c)}(a,b,c)};g.dom.each(e,function(a,g){"&nbsp;"==g&&(g=e[a]=" ");if(1==g.length){b=j(e,
a,-1);c=g;d=j(e,a,1);switch(c){case i:case k:c="'";case "'":var h;if(h=null==b||f(b))if(h=/\d/.test(d))h=/\d/.test(j(e,a,2))&&l(j(e,a,3));h?c=k:null==b||(f(b)||"("===b)&&!f(d)?c=i:null==d||!f(b)&&l(d)?c=k:/\w/.test(b)&&/\w/.test(d)&&(c=k);break;case m:case n:c='"';case '"':if(l(d)&&f(b)&&o(j(e,a,-2)))c=n;else if(null==b||(f(b)||"("===b)&&!f(d))c=m;else if(null==d||!f(b)&&l(d))c=n;else if((null==b||f(b))&&f(d)&&o(j(e,a,1)))c=m}null!=c&&(e[a]=c)}});g.dom.setHtml(h,e.join(""))}}};g.dom.noInclusionInherits(i,
g.IcePlugin);this.ice._plugin.IceSmartQuotesPlugin=i}).call(this);